<html  >
<head>
  <!-- Site made partly with Mobirise Website Builder v4.12.3, https://mobirise.com -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Mobirise v4.12.3, mobirise.com">
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1">
  <link rel="shortcut icon" href="assets/images/mbr-122x158.png" type="image/x-icon">
  <meta name="description" content="Website Creator Description">
  
  
  <title>Display Recipes</title>
  <link rel="stylesheet" href="assets/web/assets/mobirise-icons/mobirise-icons.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-grid.min.css">
  <link rel="stylesheet" href="assets/bootstrap/css/bootstrap-reboot.min.css">
  <link rel="stylesheet" href="assets/dropdown/css/style.css">
  <link rel="stylesheet" href="assets/tether/tether.min.css">
  <link rel="stylesheet" href="assets/theme/css/style.css">
  <link rel="stylesheet" href="assets/gallery/style.css">
  <link rel="preload" as="style" href="assets/mobirise/css/mbr-additional.css"><link rel="stylesheet" href="assets/mobirise/css/mbr-additional.css" type="text/css">
    
    <style>
        #ingredientsSection {
            overflow:hidden;
            float:left;
            width: 220px;
        }
        #gallery1-8 {
           float: left;
        }
        #ingredients {
            margin-top: 100px;
        }
    </style>
  
</head>
<body>
  <section class="menu cid-qTkzRZLJNu" once="menu" id="menu1-7">

    

    <nav class="navbar navbar-expand beta-menu navbar-dropdown align-items-center navbar-fixed-top navbar-toggleable-sm">
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
                <span></span>
            </div>
        </button>
        <div class="menu-logo">
            <div class="navbar-brand">
                <span class="navbar-logo">
                    <a href="index.php">
                         <img src="assets/images/mbr-122x158.png" alt="Mobirise" title="" style="height: 3.8rem;">
                    </a>
                </span>
                <span class="navbar-caption-wrap"><a class="navbar-caption text-white display-4" href="index.php">
                        Recipe Prophet</a></span>
            </div>
        </div>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav nav-dropdown" data-app-modern-menu="true"><li class="nav-item">
                    <a class="nav-link link text-white display-4" href="index.php"><span class="mbri-info mbr-iconfont mbr-iconfont-btn"></span>
                        
                        About Us
                    </a>
                </li></ul>
            <div class="navbar-buttons mbr-section-btn"><a class="btn btn-sm btn-primary display-4" href="index.php"><span class="mbri-question mbr-iconfont mbr-iconfont-btn"></span>
                    Help</a></div>
        </div>
    </nav>
</section>

<section id="ingredientsAndGallerySection">
    <section id="ingredientsSection">
        <div><ul name="ingredients" id="ingredients">Ingredients: </ul>
        </div>
    </section>
    <section class="mbr-gallery mbr-slider-carousel cid-rXMgNWDBnJ" id="gallery1-8">



        <div class="container">

            <div><!-- Filter --><div class="mbr-gallery-filter container gallery-filter-active"><ul buttons="0"><li class="mbr-gallery-filter-all"><image width="50" src="assets/images/undo.png" onclick="history.back()"></image><a class="btn btn-md btn-primary-outline active display-7" href="">All</a></li></ul></div><div><center><a href="keepSearchingErrorPrompt.php">Keep Searching for Recipes</a></center></div><!-- Gallery --><div class="mbr-gallery-row"><div class="mbr-gallery-layout-default"><div><div id="recipeProphetRecipeGallery"><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Salad, Easy, Light" onclick="location.href='index.php'"><div><img src="assets/images/mbr-10-1920x1280-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Caprese Salad</span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Spicy, Heavy" onclick="location.href='index.php'"><div><img src="assets/images/mbr-1920x1287-800x536.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Porkbelly w/ Rice</span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Heavy, Easy" onclick="location.href='index.php'"><div><img src="assets/images/mbr-5-1920x1280-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Pepper-Mushroom Soup<br></span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Light" onclick="location.href='index.php'"><div><img src="assets/images/mbr-9-1920x1280-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Curry Chicken</span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Light, Japanese" onclick="location.href='index.php'"><div><img src="assets/images/mbr-3-1920x1280-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">California Roll Sushi</span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Salad, Light, Easy" onclick="location.href='index.php'"><div><img src="assets/images/mbr-1920x1281-800x534.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">House Salad</span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Salad" onclick="location.href='index.php'"><div><img src="assets/images/mbr-7-1920x1280-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Shrimp Pasta Salad<br></span></div></div><div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Easy" onclick="location.href='index.php'"><div><img src="assets/images/mbr-1920x1279-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Lettuce, Ham, Tomato Sandwiches</span></div></div></div></div><div class="clearfix"></div></div></div><!-- Lightbox --><div data-app-prevent-settings="" class="mbr-slider modal fade carousel slide" tabindex="-1" data-keyboard="true" data-interval="false" id="lb-gallery1-8"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><ol class="carousel-indicators"><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="0"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="1"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="2"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="3"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="4"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="5"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" data-slide-to="6"></li><li data-app-prevent-settings="" data-target="#lb-gallery1-8" class=" active" data-slide-to="7"></li></ol><div class="carousel-inner"><div class="carousel-item"><img src="assets/images/mbr-10-1920x1280.jpg" alt="" title=""></div><div class="carousel-item"><img src="assets/images/mbr-1920x1287.jpg" alt="" title=""></div><div class="carousel-item"><img src="assets/images/mbr-5-1920x1280.jpg" alt="" title=""></div><div class="carousel-item"><img src="assets/images/mbr-9-1920x1280.jpg" alt="" title=""></div><div class="carousel-item"><img src="assets/images/mbr-3-1920x1280.jpg" alt="" title=""></div><div class="carousel-item"><img src="assets/images/mbr-1920x1281.jpg" alt="" title=""></div><div class="carousel-item"><img src="assets/images/mbr-7-1920x1280.jpg" alt="" title=""></div><div class="carousel-item active"><img src="assets/images/mbr-1920x1279.jpg" alt="" title=""></div></div><a class="carousel-control carousel-control-prev" role="button" data-slide="prev" href="#lb-gallery1-8"><span class="mbri-left mbr-iconfont" aria-hidden="true"></span><span class="sr-only">Previous</span></a><a class="carousel-control carousel-control-next" role="button" data-slide="next" href="#lb-gallery1-8"><span class="mbri-right mbr-iconfont" aria-hidden="true"></span><span class="sr-only">Next</span></a><a class="close" href="#" role="button" data-dismiss="modal"><span class="sr-only">Close</span></a></div></div></div></div></div>
        </div>

    </section>
</section>


    <?php
        include "scripts/dbConnect.php"
    ?>
    
    <script src="scripts/databaseManipulator.js"></script>
    <!--<script src="scripts/recipeSearch.js"></script>-->
    <script>
        const recipeGallery = document.getElementById('recipeProphetRecipeGallery');

        //remove all existing children from recipeGallery
        /*while (recipeGallery.firstChild) {
              recipeGallery.removeChild(recipeGallery.firstChild);
            }*/
        
        var listOfIngredients = [];
        setUpDatabase.onsuccess = function()
        {
            let objectStore = db.transaction('notes_os').objectStore('notes_os');
            objectStore.openCursor().onsuccess = function(e) {
                // Get a reference to the cursor
                let cursor = e.target.result;

                // If there is still another data item to iterate through, keep running this code
                if(cursor) {
                    //add this ingredient to an easily accessible array
                    listOfIngredients.push(cursor.value.name);
                    cursor.continue();
                }
            }
        }

        //TODO make sure recipeDatabase is open at this point
        //
        //

        //var listOfRecipes = [["testName","testLink","testImage","testTags"]];
        //var listOfRecipes = [["Caprese Salad","index.html","assets/images/mbr-10-1920x1280-800x533.jpg","Salad, Easy, Light"]];
        var listOfRecipes = [["Caprese Salad","index.html","assets/images/mbr-10-1920x1280-800x533.jpg","Salad, Easy, Light"]];
        //TODO3 searchForRecipes that returns a sorted list of recipes
        //TODO3.1 query recipeDatabase so that it returns only the recipes that fit the constraints (ease,weight for now)
        //TODO3.2 if we can use a query to do the filter we want on ingredients, do that
        <?php
            $sql = "SELECT id, link, name, tags FROM recipes";
        ?>
        //TODO1 test interactions between javascript and PHP.
        // we need php to gain access to the indexeddb contents
        <?php
            $result = $conn->query($sql);
            $resultArray = array();
        
            if ($result->num_rows > 0) {
                // output data of each row
                while($row = $result->fetch_assoc()) {
                    $rowArray = array();
                    $rowArray[] = $row["id"];
                    $rowArray[] = $row["link"];
                    $rowArray[] = $row["name"];
                    $rowArray[] = $row["tags"];
                    //$rowArray[] = $row["imglink"];
                    $resultArray[] = $rowArray;
                //echo "id: " . $row["id"]. " - Link: " . $row["link"]. " - Name: " . $row["name"]. "<br>";
                }
            } else {
                //echo "0 results";
            }
        ?>
        var encodedQueryResult = <?php echo json_encode($resultArray) ?>;
        
        //TODO3.3 compile a string for the tags
        
        //TODOeventually combine the two for loops (directly from encodedQueryResult, no need for listOfRecipes)
        var i;
        for(i = 0; i < encodedQueryResult.length; i++){
            var queryRecipeArray = encodedQueryResult[i];
            var recipeArray = ["Caprese Salad","index.html","assets/images/mbr-10-1920x1280-800x533.jpg","Salad, Easy, Light"];
            recipeArray[0] = queryRecipeArray[2];//recipe name
            recipeArray[1] = queryRecipeArray[1];//recipe link
            //recipeArray[2] = queryRecipeArray[4];//recipe image //TODO add image col to db
            recipeArray[3] = queryRecipeArray[3];//recipe tags
            listOfRecipes.push(recipeArray);
        }

        //displayRecipes that empties and fills the recipeGallery with that list of recipes

        var i;
        for(i = 0; i < listOfRecipes.length; i++)
        {
            recipe = listOfRecipes[i];

            //create and add a new html element to recipeGallery
            /*
            <div class="mbr-gallery-item mbr-gallery-item--p1" data-video-url="false" data-tags="Salad, Easy, Light" onclick="location.href='index.html'"><div><img src="assets/images/mbr-10-1920x1280-800x533.jpg" alt="" title=""><span class="icon-focus"></span><span class="mbr-gallery-title mbr-fonts-style display-7">Caprese Salad</span></div></div>
            */
            const galleryItem = document.createElement('div');
            galleryItem.className = "mbr-gallery-item mbr-gallery-item--p1";
            galleryItem.setAttribute("data-video-url","false");
            galleryItem.setAttribute("data-tags",recipe[3]); // tags
            onclickAttribute = "location.href='" + recipe[1] + "'";
            galleryItem.setAttribute("onclick",onclickAttribute); // link to recipe

            const galleryContent = document.createElement('div');
            const galleryImage = document.createElement('img');
            galleryImage.setAttribute("src",recipe[2]); // image
            galleryImage.setAttribute("alt","");
            galleryImage.setAttribute("title","");
            const gallerySpanFocus = document.createElement('span');
            gallerySpanFocus.className="icon-focus";
            const gallerySpanTitle = document.createElement('span');
            gallerySpanTitle.className = "mbr-gallery-title mbr-fonts-style display-7";
            gallerySpanTitle.textContent = recipe[0]; // name

            galleryContent.appendChild(galleryImage);
            galleryContent.appendChild(gallerySpanFocus);
            galleryContent.appendChild(gallerySpanTitle);
            galleryItem.appendChild(galleryContent);
            recipeGallery.appendChild(galleryItem);
        }
    </script>
    
    <?php

        $conn->close();
        //mysqli_close($conn);

    ?>
    
  <script src="assets/web/assets/jquery/jquery.min.js"></script>
  <script src="assets/popper/popper.min.js"></script>
  <script src="assets/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/masonry/masonry.pkgd.min.js"></script>
  <script src="assets/imagesloaded/imagesloaded.pkgd.min.js"></script>
  <script src="assets/smoothscroll/smooth-scroll.js"></script>
  <script src="assets/dropdown/js/nav-dropdown.js"></script>
  <script src="assets/dropdown/js/navbar-dropdown.js"></script>
  <script src="assets/tether/tether.min.js"></script>
  <script src="assets/vimeoplayer/jquery.mb.vimeo_player.js"></script>
  <script src="assets/bootstrapcarouselswipe/bootstrap-carousel-swipe.js"></script>
  <script src="assets/touchswipe/jquery.touch-swipe.min.js"></script>
  <script src="assets/theme/js/script.js"></script>
  <script src="assets/gallery/player.min.js"></script>
  <script src="assets/gallery/script.js"></script>
  <script src="assets/slidervideo/script.js"></script>
  
  
</body>
</html>